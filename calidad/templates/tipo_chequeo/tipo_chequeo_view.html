{% extends 'template_base.html' %}

{% block contenido %}
<div class="container-fluid">
    <h4>Tipo de Chequeo "{{ tipo_chequeo }}" </h4><hr>
    <h5>Documentos que lo utilizan</h5>
    <div class="row">
        <div class="col-sm-12">
            <input type="text" class="form-control form-control-sm" id="searchInputDoc" placeholder="Buscar...">
        </div>
    </div>
    <div class="row">
        <div class="col">
            <table class="table table-hover table-sm" style="font-size: 12px">
                <thead>
                <tr>
                    <th>Orden Trabajo</th>
                    <th>Número</th>
                    <th>Propietario</th>
                    <th>Aplica</th>
                    <th>Verificado</th>
                    <th>verificado por</th>
                    {% if 'documental.view_documento' in g_perms %}<th> </th>{% endif %}
                    {% if 'documental.change_documento' in g_perms %}<th> </th>{% endif %}
                    {% if 'documental.delete_documento' in g_perms %}<th> </th>{% endif %}
                    {% if 'calidad.add_chequeo' in g_perms %}<th> </th>{% endif %}
                </tr>
                </thead>
                <tbody id="documentsTable">
                {% for chk in chequeos %}
                {% if not chk.documento.reemplazado_por %}
                <tr>
                    <td><div data-toggle="tooltip" title="{{ chk.documento.proyecto.descripcion }}">{{ chk.documento.proyecto }}</div></td>
                    <td><div data-toggle="tooltip" title="{{ chk.documento.descripcion }}">{{ chk.documento }}</div></td>
                    <td>{{ chk.documento.propietario }}</td>
                    {% if chk.aplica %}
                        <td>SI</td>
                    {% else %}
                        <td>NO</td>
                    {% endif %}
                    {% if chk.verificado %}
                        <td>SI</td>
                    {% else %}
                        <td>NO</td>
                    {% endif %}
                    <td>{{ chk.verificado_por }}</td>
                    {% if 'documental.view_documento' in g_perms %}<td><a class="material-icons md-18" data-toggle="tooltip" title="ver datos del Documento" href="{% url 'ver_documento' pk_proy=chk.documento.proyecto.pk pk_doc=chk.documento.pk %}">visibility</a></td>{% endif %}
                    {% if 'documental.change_documento' in g_perms %}<td><a class="material-icons md-18" data-toggle="tooltip" title="Editar datos del Documento" href="{% url 'edita_documento' pk_proy=chk.documento.proyecto.pk pk_doc=chk.documento.pk %}">edit</a></td>{% endif %}
                    {% comment %} {% if 'documental.revision_documento' in g_perms %}
                        {% if doc.is_replaced %}
                        <td><i class="material-icons md-18 md-dark md-inactive" data-toggle="tooltip" title="El Documento ya posee una revisión.">file_copy</i></td>
                        {% else %}
                        <td><a class="material-icons md-18" data-toggle="tooltip" title="Crear una revisión del Documento" href="{% url 'revision_documento' pk_proy=pr.pk pk_doc=doc.pk %}">file_copy</a></td>
                        {% endif %}
                    {% endif %} {% endcomment %}
                    {% if 'documental.delete_documento' in g_perms %}<td><a class="material-icons md-18" data-toggle="tooltip" title="Eliminar el Documento" href="{% url 'elimina_documento' pk_proy=chk.documento.proyecto.pk pk_doc=chk.documento.pk %}">delete</a></td>{% endif %}
                    {% if 'calidad.add_chequeo' in g_perms %}
                        <td><a class="material-icons md-18" data-toggle="tooltip" title="Asignar Chequeos al Documento" href="{% url 'agrega_chequeo' pk_proy=chk.documento.proyecto.pk pk_doc=chk.documento.pk %}">playlist_add_check</a></td>
                    {% endif %}
                    {% if 'calidad.change_chequeo' in g_perms %}
                        <td><a class="material-icons md-18" data-toggle="tooltip" title="Verificar el Documento" href="{% url 'hace_chequeo' pk_proy=chk.documento.proyecto.pk pk_doc=chk.documento.pk %}">done_all</a></td>
                    {% endif %}
                    {% comment %} <td><a class="material-icons md-18" data-toggle="tooltip" title="Verificar el Documento" href="{% url 'hace_chequeo' pk_proy=pr.pk pk_doc=doc.pk %}">place</a></td> {% endcomment %}
                </tr>
                {% endif %}
                {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
<script>
    function onOffDoc(tableRow) {
        var value = $("#searchInputDoc").val().toLowerCase();
        if (tableRow.text().toLowerCase().indexOf(value) > -1) {
            // Mostrar
            tableRow.show();
        } else { // No mostrar
            tableRow.hide();
        }
    }

    $(document).ready(function(){
        $("#searchInputDoc").on("keyup", function() {
            $("#documentsTable tr").filter(function() {
                onOffDoc($(this));
            });
        });
    });
</script>
{% endblock %}